#!/bin/sh
#/ Usage: bitrate [file...]

br() {
  b=$(mp3info -r a -p "%f: %r\n" "$1" | rev | cut -d '.' -f2- | rev)
  echo "$b kbps"
}

[ -n "$1" ] || {
  grep "^#/" $0 | cut -c4- >&2
  exit 2
}

for x in "$@"; do
  if [ -d "$x" ]; then
    find "$x" -name '*.mp3' -maxdepth 1 | sort | while read -r y; do
      br "$y"
    done
  else
    br "$x"
  fi
done
